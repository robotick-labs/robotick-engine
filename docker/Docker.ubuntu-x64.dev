FROM ubuntu:24.04

RUN apt-get update && apt-get install -y git curl build-essential cmake && apt-get clean

# ðŸ§± Root-level setup (install packages and MQTT libs)
COPY ./1_setup_my_env_as_root.ubuntu.sh /1_setup_my_env_as_root.ubuntu.sh
RUN chmod +x /1_setup_my_env_as_root.ubuntu.sh && /1_setup_my_env_as_root.ubuntu.sh

# ðŸ§‘ User-level setup (e.g. Python venv, editable install)
COPY ./2_setup_my_env_as_user.ubuntu.sh /2_setup_my_env_as_user.ubuntu.sh

WORKDIR /workspace
COPY . .

# ðŸš€ Run user-level script (non-root context, if needed during build)
# Or leave this for dev container shell if venv activation is interactive
RUN chmod +x /2_setup_my_env_as_user.ubuntu.sh

CMD [ "bash" ]
